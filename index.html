<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSChE Unilag payment page</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <nav>
            <div class="navtext_div">
                <p>NSChE UNILAG Chapter</p>
            </div>
        </nav>
    </header>
    <main class="grid_container">
        <section class="grid_items banner_section">
            <img src="./nschelogo.png" alt="NSChE Logo">
            <div>
                <h1>PAY YOUR DUES</h1>
                <h2>Fast & Easy</h2>
            </div>
        </section>
        <section class="grid_items">
            <form id="paystackForm">
                <p>Pls ensure you input your correct name as should appear on your receipt</p>
                <div class="input_field">
                    <input type="text" name="firstname" id="firstName" placeholder="First Name" required>
                </div>
                <div class="input_field">
                    <input type="text" name="lastname" id="lastName" placeholder="Last Name" required>
                </div>
                <div class="input_field">
                    <input type="email" name="emailaddress" id="emailAddress" placeholder="Email Address" required>
                </div>
                <div class="input_field">
                    <input type="text" id="amount" readonly value="NGN 5000.00">
                </div>
                <div class="input_field">
                    <input type="number" name="matricNo" id="matricNo" placeholder="Matric Number" required>
                </div>
                <div class="input_field">
                    <select name="selectLevel" id="selectLevel">
                        <option value="null">SELECT LEVEL</option>
                        <option value="100">100 LEVEL</option>
                        <option value="200">200 LEVEL</option>
                        <option value="300">300 LEVEL</option>
                        <option value="400">400 LEVEL</option>
                        <option value="500">500 LEVEL</option>
                    </select>
                </div>
                
                <div class="input_field">
                    <button id="submit-btn" class="success-btn" type="submit" onclick="payWithPaystack()" disabled>MAKE PAYMENT</button>
                </div>
            </form>
        </section>
    </main>
    <footer>
        <section class="footer_section">
            <small>copyright2023</small>
        </section>
    </footer>
    <script src="script.js"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>

    <script>
        const paystackForm = document.getElementById("paystackForm");
        paystackForm.addEventListener("submit", payWithPaystack, false);
        function payWithPaystack(e){
            e.preventDefault();
            let handler = PaystackPop.setup(
                {
                    key:"pk_test_09fc76f50acf2edb6dcc24febd8e33364d46e0ce",
                    email:document.getElementById("emailAddress").value,
                    amount:5000*100,
                    ref: 'CHG'+Math.floor((Math.random() * 1000000000) + 1),
                    // metadata:{
                    //   custom_field:[
                    //         {
                    //             first_name: firstName,
                    //             last_name: lastName,
                    //         }
                    //     ]
                    // },
                    metadata: {
                      cart_id: 398,
                      custom_fields: [
                         { 
                              display_name: "first name", 
                              variable_name: "first_name", 
                              value: document.getElementById("firstName").value
                         },
                         { 
                              display_name: "last name", 
                              variable_name: "last_name", 
                              value: document.getElementById("lastName").value
                         },
                         { 
                              display_name: "level", 
                              variable_name: "level", 
                              value: document.getElementById("selectLevel").value
                         },
                         { 
                              display_name: "matric number", 
                              variable_name: "matric_number", 
                              value: document.getElementById("matricNo").value
                         }
                       ]
                    },
                    // "metadata": {
                    //     "cart_id": 398,
                    //     "custom_fields": [
                    //       {
                    //         "display_name": "first name",
                    //         "variable_name": "first_name",
                    //         "value": authStore.user.first_name
                    //       },
                    //       {
                    //         "display_name": "last name",
                    //         "variable_name": "last_name",
                    //         "value": authStore.user.last_name
                    //       }, 
                    //     ]
                    // },
                    currency: 'NGN',
                    onclose: function (params) {
                        alert("window closed.");
                    },
                    callback: function (response) {
                        let message = "payment complete! Reference: " + response.reference + " check your mail for your receipt";
                        alert(message);
                    }
                }
            );
            handler.openIframe();
        }
    </script>
</body>
</html>
